<!DOCTYPE html>
<html>
<head>
  <title>Kalkulator Atap L</title>
  <style>
    body {
      font-family: 'Segoe UI', sans-serif;
      background: #f5f7fa;
      padding: 30px;
      color: #333;
    }

    h2 {
      text-align: center;
      color: #155fa0;
    }

    label {
      font-size: 14px;
    }

    input[type="number"] {
      padding: 5px 8px;
      margin: 5px 0;
      font-size: 14px;
      width: 100px;
    }

    button {
      background-color: #1976d2;
      color: white;
      border: none;
      padding: 10px 20px;
      font-size: 14px;
      cursor: pointer;
      border-radius: 4px;
      transition: background 0.3s;
    }

    button:hover {
      background-color: #135ba1;
    }

    .box-result {
      margin-top: 20px;
      padding: 15px 20px;
      border-radius: 6px;
      background: #ffffff;
      box-shadow: 0 2px 6px rgba(0,0,0,0.1);
      width: fit-content;
    }

    .visual-wrapper {
      position: relative;
      border: 2px solid #444;
      background-color: #e0e0e0;
      box-shadow: inset 0 0 5px #aaa;
    }

    .visual-box {
      position: absolute;
      background-color: #64b5f6;
      border: 1px solid #444;
      transition: all 0.3s ease;
    }

    .semi-box {
      position: absolute;
      background-color: #81c784;
      transition: all 0.3s ease;
    }

    .dimension-label {
      position: absolute;
      font-size: 11px;
      background: white;
      padding: 3px 5px;
      border-radius: 3px;
      box-shadow: 0 1px 3px rgba(0,0,0,0.1);
      font-weight: bold;
      z-index: 20;
    }

    .visual-container {
      display: flex;
      justify-content: center;
      margin-top: 15px;
    }

    #hasilL {
      background: #fff;
      padding: 15px;
      margin-top: 20px;
      border-radius: 5px;
      box-shadow: 0 1px 5px rgba(0,0,0,0.1);
      max-width: 400px;
    }

    #hasilL div {
      margin: 4px 0;
    }
    
    .input-box {
  width: 100%;
  padding: 8px 10px;
  margin-top: 5px;
  margin-bottom: 12px;
  border: 1px solid #ccc;
  border-radius: 6px;
  font-size: 14px;
  transition: border 0.3s;
  box-sizing: border-box;
}

.input-box:focus {
  border-color: #1976d2;
  outline: none;
  box-shadow: 0 0 3px rgba(25, 118, 210, 0.4);
}
  </style>
</head>
<body>
<h2 style="text-align: center; color: #1976d2;">üü¶ Kalkulator Atap Tipe L</h2>

<div style="max-width: 420px; margin: 0 auto; background: #fff; padding: 20px 25px; border-radius: 10px; box-shadow: 0 2px 10px rgba(0,0,0,0.1);">

  <div style="display: flex; gap: 10px;">
    <div style="flex: 1;">
      <label for="p1">Panjang 1 (P1):</label>
      <input type="number" id="p1" step="0.01" value="2.40" class="input-box">
    </div>
    <div style="flex: 1;">
      <label for="l1">Lebar 1 (L1):</label>
      <input type="number" id="l1" step="0.01" value="6" class="input-box">
    </div>
  </div>

  <div style="display: flex; gap: 10px;">
    <div style="flex: 1;">
      <label for="p2">Panjang 2 (P2):</label>
      <input type="number" id="p2" step="0.01" value="2.35" class="input-box">
    </div>
    <div style="flex: 1;">
      <label for="l2">Lebar 2 (L2):</label>
      <input type="number" id="l2" step="0.01" value="4" class="input-box">
    </div>
  </div>

  <label style="display:block; margin-top: 8px;">
    <input type="checkbox" id="useBalok"> Tambahan balok?
  </label>
  <input type="number" id="balok" step="0.01" placeholder="Luas balok (m¬≤)" style="display:none;" class="input-box">

  <label style="display:block; margin-top: 8px;">
    <input type="checkbox" id="useSemi"> Tambahan semi (50%)
  </label>

  <button onclick="hitungL()" style="margin-top: 15px;">Hitung</button>
</div>

<div id="captureArea">
  <div id="hasilL"></div>
  <div id="boxL" class="box-result" style="display:none;"></div>
</div>
<div style="margin-top: 15px; text-align: center;">
  <button onclick="downloadImage()">üì∑ Download Gambar</button>
</div>

<script src="https://cdn.jsdelivr.net/npm/html2canvas@1.4.1/dist/html2canvas.min.js"></script>
  <script>
    document.getElementById("useBalok").addEventListener("change", () => {
      document.getElementById("balok").style.display = document.getElementById("useBalok").checked ? "inline-block" : "none";
    });

    function formatRupiah(angka) {
      return angka.toLocaleString('id-ID', { style: 'currency', currency: 'IDR' });
    }

    function hitungL() {
      const p1 = parseFloat(document.getElementById("p1").value);
      const l1 = parseFloat(document.getElementById("l1").value);
      const p2 = parseFloat(document.getElementById("p2").value);
      const l2 = parseFloat(document.getElementById("l2").value);
      const useBalok = document.getElementById("useBalok").checked;
      const tambahan = useBalok ? parseFloat(document.getElementById("balok").value) || 0 : 0;
      const useSemi = document.getElementById("useSemi").checked;

      if (isNaN(p1) || isNaN(l1) || isNaN(p2) || isNaN(l2)) {
        document.getElementById("hasilL").innerText = "Mohon isi semua ukuran bidang.";
        return;
      }

      const luas1 = p1 * l1;
      const luas2 = p2 * l2;
      const totalLuas = luas1 + luas2;
      const semi = useSemi ? totalLuas * 0.5 : 0;
      const totalFinal = totalLuas + semi + tambahan;
      const biaya = totalFinal * 150000;

      document.getElementById("hasilL").innerHTML = `
        <h3>üìè Hasil Perhitungan:</h3>
        <div>Luas 1 = ${p1} √ó ${l1} = ${luas1.toFixed(2)} m¬≤</div>
        <div>Luas 2 = ${p2} √ó ${l2} = ${luas2.toFixed(2)} m¬≤</div>
        <div>Total Luas = ${totalLuas.toFixed(2)} m¬≤</div>
        ${useSemi ? `<div>Tambahan Semi (50%) = ${semi.toFixed(2)} m¬≤</div>` : ""}
        ${useBalok ? `<div>Tambahan Balok = ${tambahan.toFixed(2)} m¬≤</div>` : ""}
        <div><b>Total Luas Akhir = ${totalFinal.toFixed(2)} m¬≤</b></div>
        <div><b>Total Biaya = ${formatRupiah(biaya)}</b></div>
      `;

      const scale = 20;
      const w1 = p1 * scale, h1 = l1 * scale;
      const w2 = p2 * scale, h2 = l2 * scale;
      const containerWidth = w1 + w2;
      const containerHeight = Math.max(h1, h2);

      const box1Style = `top:0; left:0; width:${w1}px; height:${h1}px;`;
      const box2Style = `
        top:${h1 - h2}px;
        left:${w1}px;
        width:${w2}px;
        height:${h2}px;
        border-top: 1px solid #555;
        border-right: 1px solid #555;
        border-bottom: 1px solid #555;
        border-left: none;
      `;

      const semiBox = useSemi ? (() => {
        const shrink = 0.6;
        const semiW1 = w1 * shrink;
        const semiH1 = h1 * shrink;
        const semiW2 = w2 * shrink;
        const semiH2 = h2 * shrink;

        const semiTotalWidth = semiW1 + semiW2;
        const semiTotalHeight = Math.max(semiH1, semiH2);

        const offsetX = (containerWidth - semiTotalWidth) / 2;
        const offsetY = (containerHeight - semiTotalHeight) / 2;

        const adjustmentY = 10;
        const adjustmentX = 10;
        const extendHeight1 = 15;
        const widenBox2 = 15;

        const semiBox1 = `
          <div class="semi-box" style="
            top:${offsetY + adjustmentY - extendHeight1}px;
            left:${offsetX - adjustmentX}px;
            width:${semiW1}px;
            height:${semiH1 + extendHeight1}px;
          "></div>`;

        const semiBox2 = `
          <div class="semi-box" style="
            top:${offsetY + (semiH1 - semiH2) + adjustmentY}px;
            left:${offsetX + semiW1 - adjustmentX}px;
            width:${semiW2 + widenBox2}px;
            height:${semiH2}px;
          "></div>`;

        return semiBox1 + semiBox2;
      })() : "";

      document.getElementById("boxL").style.display = "block";
      document.getElementById("boxL").innerHTML = `
        <div class="visual-container">
          <div class="visual-wrapper" style="width:${containerWidth}px; height:${containerHeight}px;">
            <div class="visual-box" style="${box1Style}"></div>
            <div class="visual-box" style="${box2Style}"></div>
            ${semiBox}
            <span class="dimension-label" style="top:0; left:${w1 / 2}px;">${p1}m</span>
            <span class="dimension-label" style="top:${h1 / 2}px; left:-8px; transform:rotate(90deg) translateY(-50%); transform-origin: left center;">${l1}m</span>
            <span class="dimension-label" style="top:${h1 - h2 - 15}px; left:${w1 + w2 / 2}px; transform:translateX(-50%);">${p2}m</span>
            <span class="dimension-label" style="top:${h1 - h2 + h2 / 2}px; left:${w1 + w2}px; transform:rotate(90deg) translateY(-50%); transform-origin: left center;">${l2}m</span>
          </div>
        </div>
      `;
    }
    
    function downloadImage() {
  const target = document.getElementById('captureArea');
  html2canvas(target).then(canvas => {
    const link = document.createElement('a');
    link.download = 'atap-l.png';
    link.href = canvas.toDataURL('image/png');
    link.click();
  });
}
  </script>
</body>
</html>